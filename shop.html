<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Shop — Yaldah Issa</title>
  <meta name="description" content="Shop Yaldah Issa — luxury essentials for women. Preview collections: Power Suits, Signature Dresses, Rich Aunty Sets." />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">

  <!-- bump version when you edit -->
  <link rel="stylesheet" href="assets/styles.css?v=17" />
</head>

<body>

  <!-- HEADER (same as index) -->
  <header class="site-header" aria-label="Site header">
    <div class="header-left">
      <button class="menu-btn" id="menuBtn" aria-label="Open menu" aria-expanded="false" aria-controls="menuPanel">
        <span></span><span></span><span></span>
      </button>
    </div>

    <div class="header-center">
      <a class="brandmark" href="index.html" aria-label="Yaldah Issa Home">
        <img src="assets/IMG_2654.jpeg" alt="Yaldah Issa Logo" class="brand-logo">
        <span class="brand-name">YALDAH ISSA</span>
      </a>
    </div>

    <div class="header-right">
      <nav class="topnav" aria-label="Primary navigation">
        <a class="navpill" href="index.html">Home</a>
        <a class="navpill" href="shop.html">Shop</a>
        <a class="navpill" href="about.html">About</a>
        <a class="navpill" href="contact.html">Contact</a>

        <form class="navsearch" action="shop.html" method="get" role="search" aria-label="Search">
          <input class="navsearch-input" name="q" placeholder="Search" aria-label="Search products" />
          <button class="navsearch-btn" type="submit" aria-label="Search">Search</button>
        </form>

        <a class="navpill navpill-cart" href="cart.html">Cart (<span id="cartCount">0</span>)</a>
      </nav>
    </div>

    <div class="menu-panel" id="menuPanel" role="dialog" aria-label="Menu" aria-hidden="true">
      <a class="menu-item" href="shop.html?collection=Rich%20Aunty%20Sets">Rich Aunty Sets</a>
      <a class="menu-item" href="shop.html?collection=Signature%20Dresses">Signature Dresses</a>
      <a class="menu-item" href="shop.html?collection=Power%20Suits">Power Suits</a>
    </div>
    <div class="menu-backdrop" id="menuBackdrop" aria-hidden="true"></div>
  </header>

  <main class="container">

    <!-- SHOP TOP -->
    <section class="shop-top">
      <div>
        <div class="shop-kicker">Shop Preview</div>
        <h1 class="shop-title">Collections</h1>
        <p class="shop-sub">
          Preview only — no full designs shown. Select a collection to view curated pieces.
        </p>
      </div>

      <div class="shop-meta">
        <span class="shop-chip" id="activeCollectionChip">All Collections</span>
        <span class="shop-chip" id="activeQueryChip" style="display:none;"></span>
      </div>
    </section>

    <!-- FILTER PILLS -->
    <section class="shop-filters" aria-label="Shop filters">
      <a class="filter-pill" href="shop.html">All</a>
      <a class="filter-pill" href="shop.html?collection=Power%20Suits">Power Suits</a>
      <a class="filter-pill" href="shop.html?collection=Signature%20Dresses">Signature Dresses</a>
      <a class="filter-pill" href="shop.html?collection=Rich%20Aunty%20Sets">Rich Aunty Sets</a>
    </section>

    <!-- PRODUCTS GRID -->
    <section class="shop-grid-wrap" aria-label="Products">
      <div class="shop-grid" id="productGrid"></div>

      <div class="shop-empty" id="emptyState" style="display:none;">
        No items match your selection. Try another collection.
      </div>
    </section>

    <!-- FOOTER -->
    <footer class="footer">
      <div>© <span id="year"></span> Yaldah Issa — Excellence With Purpose</div>
      <div class="footer-links">
        <a href="policies/shipping.html">Shipping</a> •
        <a href="policies/returns.html">Returns</a> •
        <a href="policies/privacy.html">Privacy</a> •
        <a href="policies/terms.html">Terms</a>
        <span class="sep">|</span>
        <span>Contact: <a href="mailto:yaldahisa@gmail.com">yaldahisa@gmail.com</a></span>
      </div>
    </footer>
  </main>

  <!-- helpers -->
  <script type="module">
    import { setYear, setCartCount } from "./assets/app.js";
    setYear(); setCartCount();
  </script>

  <!-- SHOP RENDER (REAL PRODUCTS) -->
  <script type="module">
    import { PRODUCTS } from "./assets/products.js";

    // Clean ugly URLs like ?q=. or empty q
    const url = new URL(window.location.href);
    const qRaw = (url.searchParams.get("q") || "").trim();
    if (!qRaw || qRaw === ".") {
      url.searchParams.delete("q");
      window.history.replaceState({}, "", url.pathname + (url.search ? url.search : "") + url.hash);
    }

    const params = new URLSearchParams(window.location.search);
    const collection = (params.get("collection") || "").trim();
    const q = (params.get("q") || "").trim().toLowerCase();

    // Update chips
    const colChip = document.getElementById("activeCollectionChip");
    const qChip = document.getElementById("activeQueryChip");
    colChip.textContent = collection ? collection : "All Collections";
    if (q) {
      qChip.style.display = "inline-flex";
      qChip.textContent = `Search: ${q}`;
    }

    // Make the right pill active
    document.querySelectorAll(".filter-pill").forEach(a => {
      const aUrl = new URL(a.getAttribute("href"), window.location.origin);
      const aCol = (aUrl.searchParams.get("collection") || "").trim();
      if ((aCol || "") === (collection || "")) a.classList.add("active");
      if (!aCol && !collection) a.classList.add("active");
    });

    // Filter real products
    const filtered = PRODUCTS.filter(p => {
      const matchCol = collection ? p.collection === collection : true;

      const matchQ = q
        ? (p.name || "").toLowerCase().includes(q)
          || (p.collection || "").toLowerCase().includes(q)
          || (p.color || "").toLowerCase().includes(q)
          || (p.fabric || "").toLowerCase().includes(q)
        : true;

      return matchCol && matchQ;
    });

    // Render
    const grid = document.getElementById("productGrid");
    const empty = document.getElementById("emptyState");
    grid.innerHTML = "";

    if (!filtered.length) {
      empty.style.display = "block";
    } else {
      empty.style.display = "none";

      filtered.forEach(p => {
        const price = `$${(Number(p.price_cents || 0) / 100).toFixed(2)}`;
        const img = (p.images && p.images[0]) ? p.images[0] : "";

        const card = document.createElement("article");
        card.className = "product-card";
        card.innerHTML = `
          <a class="product-link" href="product.html?id=${encodeURIComponent(p.id)}" aria-label="View ${p.name}">
            <div class="product-media">
              ${img ? `<img src="${img}" alt="${p.name}" loading="lazy">` : `<div class="product-fallback"></div>`}
            </div>
            <div class="product-body">
              <div class="product-collection">${p.collection || ""}</div>
              <h3 class="product-title">${p.name || ""}</h3>
              <div class="product-row">
                <div class="product-price">${price}</div>
                <span class="product-btn">View →</span>
              </div>
            </div>
          </a>
        `;
        grid.appendChild(card);
      });
    }
  </script>

  <!-- MENU SCRIPT -->
  <script>
    const menuBtn = document.getElementById("menuBtn");
    const menuPanel = document.getElementById("menuPanel");
    const menuBackdrop = document.getElementById("menuBackdrop");

    function closeMenu(){
      if(!menuBtn || !menuPanel || !menuBackdrop) return;
      menuBtn.setAttribute("aria-expanded","false");
      menuPanel.classList.remove("open");
      menuBackdrop.classList.remove("open");
      menuPanel.setAttribute("aria-hidden","true");
    }

    function openMenu(){
      if(!menuBtn || !menuPanel || !menuBackdrop) return;
      menuBtn.setAttribute("aria-expanded","true");
      menuPanel.classList.add("open");
      menuBackdrop.classList.add("open");
      menuPanel.setAttribute("aria-hidden","false");
    }

    menuBtn?.addEventListener("click", () => {
      const isOpen = menuBtn.getAttribute("aria-expanded") === "true";
      isOpen ? closeMenu() : openMenu();
    });

    menuBackdrop?.addEventListener("click", closeMenu);
    window.addEventListener("keydown", (e)=>{ if(e.key === "Escape") closeMenu(); });
  </script>

</body>
</html>


